# GalGame API文档
## 引擎
类名：`GalGameEngine`  
方法
| 方法名 | 返回值 | 描述 |
|-----|------|------|
| [等待(`float` 时间)](#等待) |  `nil` | 暂停执行一段时间 |
|  [转场命令(`string` 图层, `string` 命令)](#转场命令) | `bool` | 应用转场命令 |
|  [图片转场命令(`string` 图层, `string` 图片路径, `string` 命令)](#图片转场命令) | `bool` | 应用自定义转场命令 |
|  [加载剧情脚本(`string` 脚本路径)](#加载剧情脚本) | `bool` | 加载剧情脚本 |  
|  [加载存档( `GalGameSaveArchive` 存档路径)](#加载存档) | `bool` | 加载存档[`GalGameSaveArchive`](#galgame存档) |  
|  [创建人物(`string` 人物名称)](#创建人物) | [`GalCharacter`](#galgame人物) | 创建人物对象 |  
|  [显示背景(`string` 图片路径)](#显示背景) | [`GalSprite`](#galgame精灵) | 显示背景图片 |  
|  [显示背景(`float4` 颜色)](#显示背景) | [`GalSprite`](#galgame精灵) | 显示背景颜色 |  
|  [显示前景(`string` 图片路径)](#显示前景) | [`GalSprite`](#galgame精灵) | 显示前景图片 |  
|  [显示前景(`float4` 颜色)](#转场命令) | [`GalSprite`](#galgame精灵) | 显示前景颜色 |  
|  [显示屏幕(`string` 图片路径)](#转场命令) | [`GalSprite`](#galgame精灵) | 显示屏幕图片 |  
|  [显示屏幕(`float4` 颜色)](#转场命令) | [`GalSprite`](#galgame精灵) | 显示屏幕颜色 |  
|  [播放背景音乐(`string` 音乐路径)](#转场命令) | [`GalAudio`](#galgame音频) | 播放背景音乐 |  
|  [播放效果音乐(`string` 音乐路径)](#转场命令) | [`GalAudio`](#galgame音频) | 播放效果音乐 |  
|  [隐藏全部人物立绘()](#转场命令) | `nil` | 隐藏全部人物立绘 |  
|  [场景截图()](#转场命令) | `nil` | 截图 |  

属性
| 属性名 | 类型 | 描述 |
|-----|------|------|
| 对话系统 | [`GalGameDialogueSystem`](#galgame对话系统) | 对话系统 |
| 存档系统 | [`GalGameArchiveSystem`](#galgame存档系统) | 存档系统 |
| 场景系统 | [`GalGameLayeredSceneManager`](#galgame场景系统) | 场景系统 |

### 等待
- 用于在脚本中暂停执行一段时间

``` lua
GalGame.引擎:等待( 时间 )
```
| 参数 | 类型 | 描述 |
|-----|------|------|
| 时间 | float | 等待的时间（单位：秒） |

### 转场命令
``` lua
GalGame.引擎:转场命令( 图层, 命令 )
```
| 参数 | 类型 | 描述 |
|-----|------|------|
| 图层 | string | 指定要应用转场命令的图层，可选值有 "背景"、"前景"、"屏幕" |
| 命令 | string | 指定要执行的转场命令，一般格式为 "转场类型 转场时间" |
- 图层参数
    - 背景
    - 前景
    - 屏幕
- 转场类型
    - 溶解
    - 淡入
    - 淡出
    - 向左推入
    - 向右推入
    - 向上推入
    - 向下推入
- 转场时间
    - 单位：秒
    - 例如："溶解 0.5" 表示 0.5 秒内溶解

- 示例
``` lua
GalGame:转场命令( "背景", "溶解 0.5" )
```

- 用于在脚本中实现场景之间的转场效果

### 图片转场命令
- 用于在脚本中应用自定义图片转场效果

``` lua
GalGame.引擎:图片转场命令( 图层, 图片路径, 命令 )
```
| 参数 | 类型 | 描述 |
|-----|------|------|
| 图层 | string | 指定要应用转场命令的图层，可选值有 "背景"、"前景"、"屏幕" |
| 图片路径 | string | 指定要应用的图片路径 |
| 命令 | string | 指定要执行的转场命令，一般格式为 "转场时间" |

- 图层参数
    - 背景
    - 前景
    - 屏幕
- 转场时间
    - 单位：秒

``` lua
GalGame.引擎:加载剧情脚本( 脚本路径 )
```
| 参数 | 类型 | 描述 |
|-----|------|------|
| 脚本路径 | string | 剧情脚本文件的路径 |

## 对话系统
类名：`GalGameDialogueSystem`  
方法
| 方法名 | 返回值 | 描述 |
|-----|------|------|
| [继续对话()](#继续对话) | `nil` | 继续对话 |
| [完成打印对话()](#完成打印对话) | `nil` | 完成打印对话 |
| [获取对话人物()](#获取对话人物) | `string` | 获取当前正在对话的人物 |
| [获取对话文本()](#获取对话文本) | `string` | 获取当前正在打印的对话文本 |

使用示例
``` lua
GalGame.引擎.对话系统:继续对话()
```

属性
| 属性名 | 类型 | 描述 | 可写 |
|-----|------|------|-----|
| 是否正在打印对话 | `bool` | 是否正在打印对话 | 否 |
| 对话数目 | `number` | 对话系统中的对话数目 | 否 |
| 自动对话 | `bool` | 是否自动对话 | 是 |
| 快进 | `bool` | 是否快进 | 是 |
| 快进间隔时间 | `float` | 快进间隔时间（单位：秒） | 是 |
| 文字显示速度 | `float` | 文字显示速度（单位：秒/字符） | 是 |

使用示例
``` lua
GalGame.引擎.对话系统.是否正在打印对话
```

## 存档系统
类名：`GalGameArchiveSystem`  
方法
| 方法名 | 返回值 | 描述 |
|-----|------|------|
| [保存存档(`string` 存档索引)](#保存存档) | [`GalGameSaveArchive`](#galgame存档) | 保存存档 |
| [获取存档(`string` 存档索引)](#加载存档) | [`GalGameSaveArchive`](#galgame存档) | 获取存档 |
| [是否存在存档(`string` 存档索引)](#是否存在存档) | `bool` | 是否存在存档 |

使用示例
``` lua
GalGame.引擎.存档系统:是否存在存档(1)
```

## 场景系统
类名：`GalGameLayeredSceneManager`  
方法
| 方法名 | 返回值 | 描述 |
|-----|------|------|
| [获取音频层(`string` 层名)](#获取音频层) | [`GalGameLayeredSceneManagerAudioLayer`](#galgame场景系统音频层) | 获取音频层 |
| [获取精灵层(`string` 层名)](#获取精灵层)| [`GalGameLayeredSceneManagerSpriteLayer`](#galgame场景系统精灵层) | 获取音频层 |

使用示例
``` lua
GalGame.引擎.场景系统:获取音频层("背景")
```

### 场景系统音频层
类名：`GalGameLayeredSceneManagerAudioLayer`  
属性
| 属性名 | 类型 | 描述 | 可写 |
|-----|------|------|-----|
| 音量 | `float` | 音量 | 是 |

### 场景系统精灵层
类名：`GalGameLayeredSceneManagerSpriteLayer`  
属性
| 属性名 | 类型 | 描述 | 可写 |
|-----|------|------|-----|

## 存档
类名：`GalGameSaveArchive`  
属性
| 属性名 | 类型 | 描述 | 可写 |
|-------|------|------|------|
| 是否为Galgame存档 | `bool` | 判断存档是否为Galgame类型 | 否 |
| 是否有效 | `bool` | 检查存档数据的有效性 | 否 |
| 版本 | `string` | 存档文件的版本号 | 否 |
| 脚本路径 | `string` | 游戏脚本文件的存储路径 | 否 |
| 行号 | `int` | 当前游戏进度的脚本行号 | 否 |
| 存档编号字符串 | `string` | 存档的编号标识字符串 | 否 |
| 日期 | `string` | 存档创建的日期信息 | 否 |
| 时间 | `string` | 存档创建的时间信息 | 否 |
| 日期时间 | `string` | 完整的存档时间戳 | 否 |
| 描述 | `string` | 存档的描述信息 | 否 |
| 截图路径 | `string` | 存档关联的截图文件路径 | 否 |

使用示例
``` lua
local 存档 = GalGame.引擎.存档系统:获取存档(1)
print(存档.描述)
```

## 人物
类名：`GalCharacter`  
方法
| 方法名 | 返回值 | 描述 |
|-----|------|------|
| [说(`string` 对话文本)](#说) | `nil` | 说对话文本 |
| [语音(`string` 声音路径)](#语音) | `GalAudio` | 播放语音 |
| [添加立绘(`string` 立绘别名,`string` 立绘路径)](#添加立绘) | `nil` | 添加立绘 |
| [显示立绘(`string` 立绘别名)](#显示立绘) | [`GalSprite`](#galgame精灵) | 显示立绘 |
| [隐藏立绘()](#隐藏立绘) | `nil` | 隐藏立绘 |
| [添加立绘显示回调(`function` 回调函数)](#添加立绘显示回调) | `nil` | 添加立绘显示回调 |
| [清除全部立绘显示回调()](#清除全部立绘显示回调) | `nil` | 清除全部立绘显示回调 |
| [添加立绘隐藏回调(`function` 回调函数)](#添加立绘隐藏回调) | `nil` | 添加立绘隐藏回调 |
| [清除全部立绘隐藏回调()](#清除全部立绘隐藏回调) | `nil` | 清除全部立绘隐藏回调 |

使用示例
``` lua
local 人物 = GalGame.引擎:创建人物('人物1')
人物:说("你好")
```

属性
| 属性名 | 类型 | 描述 | 可写 |
|-----|------|------|-----|
| 名称 | `string` | 人物名称 | 是 |
| 当前立绘 | `GalSprite` | 当前立绘 | 否 |
| 当前语音 | `GalAudio` | 当前语音 | 否 |

## 精灵
类名：`GalSprite`  
方法
| 方法名 | 返回值 | 描述 |
|-----|------|------|
| [随着(`string` 变换命令)](#随着) | [`GalSprite`](#galgame精灵) | 随着命令语句 |
| [开始动画(`table` 目标值字典, `float` 动画时间, `string` 动画插值类型, `int` 循环次数 = 1, `bool` 是否反转 = true)](#开始动画) | `Animation2DScript` | 开始动画 |
| [转场(`string` 转场命令)](#转场) | `nil` | 转场 |
| [设置缩放(`float` 缩放值)](#设置缩放) | [`GalSprite`](#galgame精灵) | 设置缩放 |
| [设置位置偏移X(`float` 偏移值)](#设置位置偏移X) | [`GalSprite`](#galgame精灵) | 设置位置偏移X |
| [设置位置偏移Y(`float` 偏移值)](#设置位置偏移Y) | [`GalSprite`](#galgame精灵) | 设置位置偏移Y |
| [设置位置X(`float` 位置值)](#设置位置X) | [`GalSprite`](#galgame精灵) | 设置位置X |
| [设置位置Y(`float` 位置值)](#设置位置Y) | [`GalSprite`](#galgame精灵) | 设置位置Y |
| [底部对齐()](#底部对齐) | [`GalSprite`](#galgame精灵) | 底部对齐 |

使用示例
``` lua
local 图片 = GalGame.引擎:显示背景('路径')
图片:随着(‘淡入 1.0’)
```

属性
| 属性名 | 类型 | 描述 | 可写 |
|-----|------|------|-----|
| 位置X | `float` | 立绘X位置 | 是 |
| 位置Y | `float` | 立绘Y位置 | 是 |
| 宽度缩放 | `float` | 立绘宽度缩放 | 是 |
| 高度缩放 | `float` | 立绘高度缩放 | 是 |
| 路径 | `string` | 立绘路径 | 否 |

``` lua
local 图片 = GalGame.引擎:显示背景('路径')
图片.位置X = 100
```

## 音频
类名：`GalAudio`  
方法
| 方法名 | 返回值 | 描述 |
|-----|------|------|
| [设置循环播放(`bool` 是否循环)](#设置循环播放) | `GalAudio` | 设置循环播放 |
| [停止播放()](#停止播放) | `GalAudio` | 停止播放 |
| [是否正在播放()](#是否正在播放) | `bool` | 是否正在播放 |
| [是否循环播放()](#是否循环播放) | `bool` | 是否循环播放 |
| [设置音量(`float` 音量值)](#设置音量) | `GalAudio` | 设置音量 |
| [获取音量()](#获取音量) | `float` | 获取音量 |
| [随着(`string` 变换命令)](#随着) | `GalAudio` | 随着命令语句 |

使用示例
``` lua
local 音乐 = GalGame.引擎:播放背景音乐('路径')
音乐:设置循环播放(true)
``` 

属性
| 属性名 | 类型 | 描述 | 可写 |
|-----|------|------|-----|
| 循环播放 | `bool` | 是否循环播放 | 是 |
| 音量 | `float` | 音量 | 是 |
| 路径 | `string` | 立绘路径 | 否 |

``` lua
local 音乐 = GalGame.引擎:播放背景音乐('路径')
音乐.循环播放 = true
``` 